import numpy as np
import femagtools.losscoeffs

fo = 50.0
Bo = 1.5

f = [50.0, 100.0, 200.0, 400.0, 500.0, 1000.0, 2000.0]
B = [0.10103, 0.20105, 0.30106, 0.40008, 0.50109, 0.60109,
     0.70111, 0.80013, 0.90115, 1.00118, 1.10022, 1.2013,
     1.30049, 1.40116, 1.50311, 1.61841, 1.71087, 1.81709, 1.92619]

pfe = [[0.01859, 0.04461, 0.10782, 0.2838, 0.39409, 1.16244, 3.57408],
       [0.07684, 0.17722, 0.43127, 1.13022, 1.56273, 4.45273, 13.07317],
       [0.16358, 0.37426, 0.91707, 2.4104, 3.32623, 9.37392, 27.14519],
       [0.26768, 0.62212, 1.53547, 4.04873, 5.59287, 15.76365, 46.63288],
       [0.39037, 0.91211, 2.2716, 6.00803, 8.36762, 23.62688, 70.58197],
       [0.52917, 1.24424, 3.11803, 8.32548, 11.54513, 33.63035, 100.6593],
       [0.68284, 1.61478, 4.07599, 10.9825, 15.27785, 45.09369, None],
       [0.85386, 2.02498, 5.14797, 14.00635, 19.56824, 58.67124, None],
       [1.04347, 2.48104, 6.34264, 17.45898, 24.86492, 74.72488, None],
       [1.25539, 2.98914, 7.70708, 21.67625, 30.61766, 93.57929, None],
       [1.49457, 3.56541, 9.20166, 26.22441, 37.20815, 115.6707, None],
       [1.77713, 4.23834, 10.96019, 31.44426, 44.76528, 141.527, None],
       [2.12289, 5.06866, 13.09795, 37.6766, 53.71784, None, None],
       [2.50335, 6.18773, 16.00159, None, None, None, None],
       [2.89992, 7.22253, 18.82715, None, None, None, None],
       [3.35349, 8.12348, None, None, None, None, None],
       [3.65588, None, None, None, None, None, None],
       [3.97809, None, None, None, None, None, None],
       [4.28171, None, None, None, None, None, None]]


def test_steinmetz():
    c = femagtools.losscoeffs.fitsteinmetz(f, B, pfe, Bo, fo)
    np.testing.assert_almost_equal(c,
                                   (1.884, 1.5827, 2.0228),
                                   decimal=4)

    
def test_jordan():
    c = femagtools.losscoeffs.fitjordan(f, B, pfe, Bo, fo)
    np.testing.assert_almost_equal(c,
                                   (1.5702,  1.6385,
                                    1.3448,  0.4234,  2.0473),
                                   decimal=4)
    
