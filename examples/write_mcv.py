# -*- coding: utf-8 -*-
# create MC/MCV files from curve data
#
import femagtools
import logging
import os

logging.basicConfig(level=logging.INFO,
                    format='%(asctime)s %(message)s')

mcvData = [
    dict(curve=[dict(
        bi=[0.0, 0.09, 0.179, 0.267, 0.358,
            0.45, 0.543, 0.6334, 0.727,
            0.819, 0.9142, 1.0142, 1.102,
            1.196, 1.314, 1.3845, 1.433,
            1.576, 1.677, 1.745, 1.787,
            1.81, 1.825, 1.836],
        
        hi=[0.0, 22.16, 31.07, 37.25, 43.174,
            49.54, 56.96, 66.11, 78.291,
            95, 120.64, 164.6, 259.36,
            565.86, 1650.26, 3631.12, 5000, 10000,
            15000, 20000, 25000, 30000, 35000, 40000])],
         desc=u"Demo Steel",
         name='M270-35A',
         ch=4.0,
         cw_freq=2.0,
         cw=1.68),
    
    dict(curve=[{"angle": 0.0,
                 "bi": [0.0, 0.5001193881034851, 0.6001256704330444,
                        0.700133204460144, 0.8001407384872437,
                        0.9001495242118835, 1.0001596212387085,
                        1.1001709699630737, 1.2001848220825195,
                        1.3002337217330933, 1.4003480672836304,
                        1.500654697418213, 1.6016123294830322,
                        1.7040778398513794, 1.8085501194000244,
                        1.9156187772750854, 1.9730873107910156],
                 "hi": [0.0, 95.0, 100.0, 106.0, 112.0, 119.0, 127.0,
                        136.0, 147.0, 186.0, 277.0, 521.0, 1283.0,
                        3245.0, 6804.0, 12429.0, 16072.6748046875]},
                {"angle": 90.0,
                 "bi": [0.0, 0.5002199411392212, 0.6002413034439087,
                        0.7002626061439514, 0.8002877831459045,
                        0.9003154039382935, 1.0003480911254883,
                        1.1003907918930054, 1.2004486322402954,
                        1.3005428314208984, 1.4007363319396973,
                        1.5012717247009277, 1.6028035879135132,
                        1.7061727046966553, 1.8115723133087158,
                        1.918825626373291, 1.9763903617858887],
                 "hi": [0.0, 175.0, 192.0, 209.0, 229.0, 251.0,
                        277.0, 311.0, 357.0, 432.0, 586.0,
                        1012.0, 2231.0, 4912.0, 9209.0, 14981.0,
                        18718.376953125]}],
         ctype=femagtools.mcv.ORIENT_CRV,
        desc="Magnetic Curve",
         rho=7.65,
         bsat=0.0,
         name="V800-50A_aniso",
         cw=0.0,
         cw_freq=0.0,
         fillfac=1.0,
         bref=0.0,
         b_coeff=0.0,
         fe_sat_mag=2.15,
         ch_freq=0.0,
         remz=0.0,
         Bo=1.5,
         ch=0.0,
         fo=50.0)
    ]

userdir = os.path.expanduser('~')
workdir = os.path.join(userdir, 'femag')
try:
    os.makedirs(workdir)
except OSError:
    pass

mcv = femagtools.mcv.MagnetizingCurve(mcvData)
for m in mcvData:
    mcv.writefile(m['name'], workdir)
